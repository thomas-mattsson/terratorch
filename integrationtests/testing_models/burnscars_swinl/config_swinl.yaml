data:
  class_path: terratorch.datamodules.GenericNonGeoSegmentationDataModule
  init_args:
    allow_substring_split_file: true
    batch_size: 4
    constant_scale: 1.0
    dataset_bands:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    drop_last: true
    expand_temporal_dimension: false
    ignore_split_file_extensions: true
    img_grep: '*tif*'
    label_grep: '*tif*'
    means:
    - 0.052829564761523104
    - 0.07822514779700994
    - 0.09545302348640401
    - 0.2128596444116123
    - 0.2363016737011897
    - 0.17234100022878698
    no_data_replace: 0.0
    no_label_replace: -1
    num_classes: 2
    num_workers: 2
    output_bands:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    pin_memory: false
    reduce_zero_label: false
    rgb_indices:
    - 0
    - 1
    - 2
    stds:
    - 0.028757146620143812
    - 0.03540772770593507
    - 0.05291947163682527
    - 0.06949186937256507
    - 0.08958868240264736
    - 0.08198354165348874
    test_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/training_data
    test_label_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/labels
    test_split: /data/geodata-060bbc44822a11efb3260a580a830dad/split_files/test_data.txt
    test_transform:
    - class_path: albumentations.pytorch.transforms.ToTensorV2
      init_args:
        {}
    train_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/training_data
    train_label_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/labels
    train_split: /data/geodata-060bbc44822a11efb3260a580a830dad/split_files/train_data.txt
    val_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/training_data
    val_label_data_root: /data/geodata-060bbc44822a11efb3260a580a830dad/labels
    val_split: /data/geodata-060bbc44822a11efb3260a580a830dad/split_files/val_data.txt
deploy_config_file: true
model:
  class_path: terratorch.tasks.SemanticSegmentationTask
  init_args:
    freeze_backbone: false
    freeze_decoder: false
    freeze_head: false
    ignore_index: -1
    loss: ce
    lr: 0.001
    model_args:
      backbone: prithvi_swin_L
      backbone_drop_path_rate: 0.3
      backbone_pretrained_cfg_overlay:
        file: /terratorch/gfm_models/prithvi_swin_L/epoch-94-loss-0.0918.pt
      backbone_window_size: 7
      bands:
      - '0'
      - '1'
      - '2'
      - '3'
      - '4'
      - '5'
      decoder: UNetDecoder
      decoder_channels:
      - 512
      - 256
      - 128
      - 64
      head_channel_list:
      - 256
      head_dropout: 0.1
      num_classes: 2
      num_frames: 1
      pretrained: false
    model_factory: PrithviModelFactory
    output_most_probable: true
    output_on_inference: prediction
    plot_on_val: 2
    tiled_inference_on_testing: false
    tiled_inference_parameters:
      average_patches: true
      h_crop: 512
      h_stride: 448
      w_crop: 512
      w_stride: 448
out_dtype: int16
seed_everything: 0
trainer:
  accelerator: auto
  accumulate_grad_batches: 1
  barebones: false
  check_val_every_n_epoch: 1
  detect_anomaly: false
  devices: auto
  enable_checkpointing: true
  fast_dev_run: false
  inference_mode: true
  log_every_n_steps: 50
  logger: null        # ‚Üê FIX HERE
  max_epochs: 2
  max_steps: -1
  num_nodes: 1
  overfit_batches: 0.0
  precision: 16-mixed
  reload_dataloaders_every_n_epochs: 0
  strategy: auto
  sync_batchnorm: false
  use_distributed_sampler: true

