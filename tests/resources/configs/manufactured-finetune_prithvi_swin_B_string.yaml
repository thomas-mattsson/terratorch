trainer:
  accelerator: auto
  strategy: auto
  devices: auto
  num_nodes: 1
  max_epochs: 1
  check_val_every_n_epoch: 1
  log_every_n_steps: 20
  enable_checkpointing: true
  default_root_dir: tests/

  logger:
    - class_path: lightning.pytorch.loggers.TensorBoardLogger
      init_args:
        save_dir: tests/
        name: all_ecos_random

  callbacks:
    - class_path: lightning.pytorch.callbacks.LearningRateMonitor
      init_args:
        logging_interval: epoch

    - class_path: lightning.pytorch.callbacks.EarlyStopping
      init_args:
        monitor: val/loss
        patience: 100

data:
  class_path: GenericNonGeoPixelwiseRegressionDataModule
  init_args:
    batch_size: 2
    num_workers: 4
    train_transform:
        - class_path: albumentations.pytorch.transforms.ToTensorV2
          init_args: {}
    dataset_bands:
      - "band_1"
      - "band_2"
      - "band_3"
      - "band_4"
      - "band_5"
      - "band_6"
      - "band_7"
      - "band_8"
      - "band_9"
      - "band_10"
    output_bands:
      - "band_2"
      - "band_3"
      - "band_4"
      - "band_5"
      - "band_6"
      - "band_7"
    rgb_indices: [2, 1, 0]
    train_data_root: tests/resources/inputs
    train_label_data_root: tests/resources/inputs
    val_data_root: tests/resources/inputs
    val_label_data_root: tests/resources/inputs
    test_data_root: tests/resources/inputs
    test_label_data_root: tests/resources/inputs
    img_grep: "regression*input*.tif"
    label_grep: "regression*label*.tif"
    means: [547.36707, 898.5121, 1020.9082, 2665.5352, 2340.584, 1610.1407]
    stds: [411.4701, 558.54065, 815.94025, 812.4403, 1113.7145, 1067.641]
    no_label_replace: -1
    no_data_replace: 0

model:
  class_path: terratorch.tasks.PixelwiseRegressionTask
  init_args:
    model_args:
      decoder: UperNetDecoder
      pretrained: false
      backbone: prithvi_swin_B
      backbone_drop_path_rate: 0.3
      decoder_channels: 256
      in_channels: 6
      bands:
        - BLUE
        - GREEN
        - RED
        - NIR_NARROW
        - SWIR_1
        - SWIR_2
      num_frames: 1
      head_dropout: 0.5708022831486758
      head_final_act: torch.nn.ReLU
      head_learned_upscale_layers: 2
    loss: rmse
    ignore_index: -1
    freeze_backbone: true
    freeze_decoder: false
    model_factory: PrithviModelFactory

optimizer:
  class_path: torch.optim.AdamW
  init_args:
    lr: 0.00013524680528283027
    weight_decay: 0.047782217873995426

lr_scheduler:
  class_path: ReduceLROnPlateau
  init_args:
    monitor: val/loss
